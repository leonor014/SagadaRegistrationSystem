<!DOCTYPE html>
<html>

<head>
    <title>Tourist Registration</title>
    <link rel="icon" type="image/x-icon" href="/SagadaRegistrationSystem/favicon.ico">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
    </script>
    <script type="text/javascript">
        (function () {
            emailjs.init({
                publicKey: "qCwoFnSDmaCx9HtKS",
            });
        })();
    </script>
    <link rel="stylesheet" href="./style.css">
    <script src="../../js/registration.js" type="module"></script>
</head>

<body id="body">
    <!-- Nav Links -->
    <nav class="navbar">
        <div class="nav-container">
            <!-- Hamburger Button -->
            <button class="hamburger" id="hamburger">â˜°</button>

            <!-- Nav Links -->
            <div class="nav-links" id="nav-links">
                <a href="/SagadaRegistrationSystem/index.html">Home</a>
                <a href="/SagadaRegistrationSystem/about/index.html">About</a>
                <a href="/SagadaRegistrationSystem/contact/index.html">Contact</a>
                <a id="registerLink" href="/SagadaRegistrationSystem/user/register/index.html">Register</a>
                <!-- <a id="touristCheckInLink"
                    href="/SagadaRegistrationSystem/user/registration-per-site/index.html">Tourist Site Check-In</a> -->
                <a id="authLink" href="/SagadaRegistrationSystem/user/user-auth.html">Login</a>
                <!-- <a id="logoutLink" href="#">Logout</a> -->
            </div>
        </div>
    </nav>

    <!-- Warning Modal (Highest Priority) -->
    <div id="warningModal" class="modal-overlay" style="z-index: 9999; display: none;">
        <div class="modal-content">
            <h2>Warning!</h2>
            <p>Your profile information is incomplete. Please update your personal details or groups to proceed with
                registration.</p>
            <button id="goToProfileBtn">Go to Profile</button>
        </div>
    </div>

    <!-- Group Required Modal -->
    <div id="groupRequiredModal" class="modal-overlay" style="z-index: 9999; display: none;">
        <div class="modal-content">
            <h2>Invalid Selection</h2>
            <p>You must create a group in your Profile page first before registering as a group.</p>
            <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center;">
                <button id="goToProfileBtnGroup">Go to Profile</button>
                <button id="closeGroupRequiredModal">Close</button>
            </div>
        </div>
    </div>



    <!-- The Modal -->
    <div id="noticeModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Notice</h2>
            <p>Welcome to the Tourist Registration Portal.
                By proceeding, you agree to provide accurate
                information for the purpose of registration.
                This information will be used to facilitate
                your travel and ensure your safety during
                your visit.</p>
            <button id="acknowledgeButton">I Understand</button>
        </div>
    </div>

    <div class="container">
        <h1>Tourist Registration</h1>

        <form id="registrationForm">
            <label>Are you registering for an/a?</label>
            <select id="groupRegistration" required>
                <option value="">Select an option</option>
                <option value="individual">Individual</option>
                <option value="group">Group</option>
            </select>

            <!-- Individual Form -->
            <div id="individualForm" style="display:none;">
                <label>Date of Registration</label>
                <input type="date" id="dateOfRegistration" required>

                <label>Full Name:</label>
                <input type="text" id="fullName" required>

                <label>Date of Birth:</label>
                <input type="date" id="dateOfBirth" required>

                <label>Sex:</label>
                <select id="sex" required>
                    <option value="">Select</option>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                </select>

                <label>Country of Origin:</label>
                <select id="country" required></select>

                <label>Region:</label>
                <select id="region" required></select>

                <label>Phone Number:</label>
                <input type="text" id="phone" required>

                <label>Email:</label>
                <input type="email" id="email" readonly required>
            </div>

            <!-- Group Form -->
            <div id="groupForm" style="display:none;">
                <label>Date of Registration</label>
                <input type="date" id="groupDateOfRegistration" required>

                <label>Select Group</label>
                <select id="existingGroupSelect" required>
                    <option value="">Select a group</option>
                </select>

                <div id="groupMembersContainer"></div>

                <div id="groupDetails" style="margin-top: 20px;">
                    <label>Country of Origin:</label>
                    <select id="groupCountry" required></select>

                    <label>Region:</label>
                    <select id="groupRegion" required></select>

                    <label>Phone Number:</label>
                    <input type="text" id="groupPhone" required>

                    <label>Email:</label>
                    <input type="email" id="groupEmail" readonly required>
                </div>
            </div>


            <button type="submit">Register</button>
        </form>

        <!-- Registration Success Modal -->
        <div id="registrationDisplay" class="modal-overlay hidden">
            <div class="modal-content" id="registrationModalContent">
                <!-- dynamic registration summary will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 Discover Sagada. All rights reserved.</p>
    </footer>

    <div id="loadingModal" class="modal-overlay hidden">
        <div class="modal-content">
            <p>Submitting your registration, please wait...</p>
        </div>
    </div>

    <div id="successModal" class="modal-overlay hidden">
        <div class="modal-content" id="successModalContent">
            <!-- dynamic registration summary will be inserted here -->
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const authLink = document.getElementById("authLink");
            const userValidated = localStorage.getItem("userValidated") === "true";

            if (userValidated) {
                authLink.textContent = "Profile";
                authLink.href = "/SagadaRegistrationSystem/user/profile/index.html";
                document.getElementById("body").style.visibility = "visible";
            } else {
                authLink.textContent = "Login";
                authLink.href = "/SagadaRegistrationSystem/user/user-auth.html";
                registerLink.style.display = "none";
                window.location.href = "/SagadaRegistrationSystem/user/user-auth.html";
                /* touristCheckInLink.style.display = "none";
                logoutLink.style.display = "none"; */
            }

            /* logoutLink.addEventListener("click", (e) => {
                e.preventDefault();
                localStorage.setItem("userValidated", "false");
                localStorage.removeItem("userId");
                localStorage.removeItem("userEmail");
                window.location.href = "/index.html";
            }); */
            const hamburger = document.getElementById("hamburger");
            const navLinks = document.getElementById("nav-links");

            // Toggle menu on hamburger click
            hamburger.addEventListener("click", (e) => {
                e.stopPropagation(); // prevent click bubbling
                navLinks.classList.toggle("show");
            });

            // Close menu if clicking outside
            document.addEventListener("click", (e) => {
                if (navLinks.classList.contains("show") && !navLinks.contains(e.target) && e.target !== hamburger) {
                    navLinks.classList.remove("show");
                }
            });
        });
    </script>

</body>

</html>